@using ASI.Basecode.Data.Models;
@model HomeViewModel
@section styles {
    <link rel="stylesheet" href="~/css/admindashboard.css" />
}
@{
    ViewData["Title"] = "Book Dashboard";
}

<div class="body-main">
    <div class="body-two-section">
        <div class="left-space">
            <div class="left-menu">
                <div>
                    <img class="bibliobibuli-logo" src="~/img/logo-leftaligned.png" />
                    <div class="menu-items">
                        <div class="leftmenu-item-title">
                            <div class="leftmenu-item active">
                                <img class="leftmenu-icons" src="~/img/dashboard-icon-active.png" />
                                Book Management<br />Dashboard
                            </div>
                        </div>
                        <hr class="menu-divider" />
                        @if (User.IsInRole("Bookmaster"))
                        {
                            <a asp-controller="Book" asp-action="BookList" class="leftmenu-items">
                                <div class="leftmenu-item">
                                    <img class="leftmenu-icons" src="~/img/booklist-icon.png" />
                                    Book List
                                </div>
                            </a>
                        }
                        @if (User.IsInRole("Genremaster"))
                        {
                            <a asp-controller="Genre" asp-action="GenreList" class="leftmenu-items">
                                <div class="leftmenu-item">
                                    <img class="leftmenu-icons" src="~/img/booklist-icon.png" />
                                    Genre List
                                </div>
                            </a>
                        }
                        @if (User.IsInRole("Superadmin"))
                        {
                            <a asp-controller="Account" asp-action="UserList" class="leftmenu-items">
                                <div class="leftmenu-item">
                                    <img class="leftmenu-icons" src="~/img/booklist-icon.png" />
                                    User List
                                </div>
                            </a>
                        }
                    </div>
                </div>
                <div>
                    <button class="logout-button">
                        <a asp-controller="Account" asp-action="SignOutUser">
                            <div class="logout-text">
                                <img class="leftmenu-icons" src="~/img/logout-icon.png" />
                                Logout
                            </div>
                        </a>
                    </button>
                </div>
            </div>
        </div>
        <div class="admin-dashboard-list">
            <div class="admin-header">
                <div class="logosec">
                    @*Welcome, @HttpContextAccessor.HttpContext.Session.GetString("UserName")!*@
                    <div class="mr-20 hover-pointer" style="position: relative">
                        <div class="dp">
                            <img src="~/img/profile-logo.png"
                                 class="dpicn hover-pointer"
                                 alt="dp">
                        </div>
                    </div>
                </div>
            </div>
            <div class="dashboard">
                <div class="dashboard-title-div">
                    <p class="dashboard-title">Administrator Book Management Dashboard</p>
                </div>
                <hr class="divider" />

                <div class="dashboard-title-div-new">
                    <p class="dashboard-subtitle-new">Newly Added Books</p>
                    <button class="view-more-button" id="AddBookBtn">
                        <a asp-controller="Book" asp-action="BooksDashboardBookList" asp-route-sortBy="CreatedTime">
                            <p class="button-text-new">
                                View More
                            </p>
                        </a>
                    </button>
                </div>

                <div class="dashboard-card">
                    <div class="admin-dashboard-books">
                        @{
                            List<Book> NewBooks = Model.NewlyReleasedBooks;
                            foreach (var book in NewBooks)
                            {
                                <div class="book-item">
                                    <a href="@Url.Action("GetGenresOfBook", "Book",
													new {
														bookId = @book.bookId,
														image = book.image, @book.author ,
														title = book.title,
														synopsis = book.synopsis,
														pubYear = book.pubYear,
														publisher = book.publisher,
														isbn = book.isbn,
														language = book.language })">
                                        <img src="@book.image" alt="@book.title">
                                        <span class="tooltip">
                                            <strong>Title:</strong> @book.title <br /><br />
                                            <strong>Synopsis:</strong> <span class="synopsis">@book.synopsis</span>
                                        </span>
                                    </a>
                                </div>
                            }
                        }
                    </div>
                </div>

                <div class="dashboard-title-div-new">
                    <p class="dashboard-subtitle-new">Top Rated Books</p>
                    <button class="view-more-button" id="AddBookBtn">
                        <a asp-controller="Book" asp-action="BooksDashboardBookList" asp-route-sortBy="Rating">
                            <p class="button-text-new">
                                View More
                            </p>
                        </a>
                    </button>
                </div>
                <div class="dashboard-card">
                    <div class="admin-dashboard-books">
                        @{
                            List<Book> TopRatedBooks = Model.TopRatedBooks;
                            foreach (var book in TopRatedBooks)
                            {
                                <div class="book-item">
                                    <a href="@Url.Action("GetGenresOfBook", "Book",
													new {
														bookId = @book.bookId,
														image = book.image, @book.author ,
														title = book.title,
														synopsis = book.synopsis,
														pubYear = book.pubYear,
														publisher = book.publisher,
														isbn = book.isbn,
														language = book.language })">
                                        <img src="@book.image" alt="@book.title">
                                        <span class="tooltip">
                                            <strong>Title:</strong> @book.title <br /><br />
                                            <strong>Synopsis:</strong> <span class="synopsis">@book.synopsis</span>
                                        </span>
                                    </a>
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script type="text/javascript" src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="~/js/Book.js"></script>
<script>
    // $(document).ready(function () {
    // 	$(".book-title-link").on("click", function (e) {
    // 		e.preventDefault();
    // 		var bookId = $(this).attr("id").replace("book-", "");

    // 		// Make an AJAX request to fetch and display genres
    // 		$.get("/BookController/GetGenresOfBook?bookId=" + bookId, function (data) {
    // 			if (data.genres) {
    // 				var genreList = data.genres.join(", "); // Convert the array of genres to a string

    // 				// Update the third column with the genre information
    // 				$(`#book-${bookId}`).closest("tr").find("td:eq(2)").html(genreList);
    // 			} else {
    // 				// Handle the case where there are no genres or an error occurred
    // 				console.log("No genres found or an error occurred.");
    // 			}
    // 		});
    // 	});
    // });
</script>

